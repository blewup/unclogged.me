<!DOCTYPE html>
<html lang="fr" class="dark scroll-smooth">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-Content-Type-Options" content="nosniff" />

    <!-- User Cache Meta Data (Simulation) -->
    <meta name="user-cache-control" content="store-all" />
    <meta name="server-log" content="conscent.php" />
    <meta
      name="description"
      content="Billy St-Hilaire Le Deboucheur - Expert en d√©bouchage et plomberie en Mont√©r√©gie."
    />
    <title>Billy St-Hilaire | Le Deboucheur</title>

    <!-- Favicons -->
    <link href="assets/images/logo/favicon.ico" rel="icon" type="image/x-icon" />
    <link
      href="assets/images/logo/favicon-16x16.png"
      rel="icon"
      sizes="16x16"
      type="image/png"
    />
    <link
      href="assets/images/logo/favicon-32x32.png"
      rel="icon"
      sizes="32x32"
      type="image/png"
    />
    <link
      href="assets/images/logo/favicon-48x48.png"
      rel="icon"
      sizes="48x48"
      type="image/png"
    />
    <link
      href="assets/images/logo/android-chrome-192x192.png"
      rel="icon"
      sizes="192x192"
      type="image/png"
    />
    <link
      href="assets/images/logo/android-chrome-512x512.png"
      rel="icon"
      sizes="512x512"
      type="image/png"
    />
    <link
      href="assets/images/logo/apple-touch-icon.png"
      rel="apple-touch-icon"
      sizes="180x180"
    />
    <meta id="msapplication-TileColor" name="msapplication-TileColor" />
    <meta content="assets/images/logo/mstile-150x150.png" name="msapplication-TileImage" />
    <link href="assets/images/logo/site.webmanifest" rel="manifest" />

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Fonts / Icons -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <link href="https://fonts.googleapis.com/css2?family=Black+Ops+One&display=swap" rel="stylesheet" />

    <!-- Tailwind Config -->
    <script>
      tailwind.config = {
        darkMode: "class",
        theme: {
          extend: {
            colors: {
              darkBase: "#000000",
              darkAlt: "#131313",
              lightBase: "#FFFFFF",
              lightAlt: "#F2F2F2",
              cardinal: "#C41E3A",
              deboucheurGreen: "#22c55e",
              websiteBlue: "#2563EB",
            },
            fontFamily: {
              ops: ['"Black Ops One"', "cursive"],
              impact: ["Impact", "Haettenschweiler", "Arial Narrow Bold", "sans-serif"],
              comic: ['"Comic Sans MS"', '"Comic Sans"', "cursive", "sans-serif"],
            },
            screens: {
              portrait: { raw: "(orientation: portrait)" },
              landscape: { raw: "(orientation: landscape)" },
            },
            animation: {
              "bounce-slow": "bounce 3s infinite",
            },
          },
        },
      };
    </script>

    <style>
      /* GLOBAL SCROLLBAR HIDE (All Browsers) */
      html,
      body {
        scrollbar-width: none; /* Firefox */
        -ms-overflow-style: none; /* IE/Edge */
        overflow-x: hidden;
      }
      ::-webkit-scrollbar {
        display: none; /* Chrome/Safari/Opera */
        width: 0;
        background: transparent;
      }

      .text-outline-black {
        text-shadow: -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000;
      }
      .theme-text-outline.dark-mode-outline {
        text-shadow: -0.5px -0.5px 0 #000, 0.5px -0.5px 0 #000, -0.5px 0.5px 0 #000,
          0.5px 0.5px 0 #000;
      }
      .theme-text-outline.light-mode-outline {
        text-shadow: -0.5px -0.5px 0 #fff, 0.5px -0.5px 0 #fff, -0.5px 0.5px 0 #fff,
          0.5px 0.5px 0 #fff;
      }

      .nav-glass {
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        transition: transform 0.3s ease-in-out, background-color 0.3s ease;
      }

      .hero-slide {
        position: absolute;
        inset: 0;
        background-size: cover;
        background-position: center;
        opacity: 0;
        transition: opacity 1.5s ease-in-out;
      }
      .hero-slide.active {
        opacity: 1;
      }

      .map-glow-dark {
        box-shadow: 0 0 20px 5px rgba(255, 255, 255, 0.2);
      }
      .map-glow-light {
        box-shadow: 0 0 20px 5px rgba(0, 0, 0, 0.2);
      }
      .map-overlay-blur {
        backdrop-filter: blur(4px);
        -webkit-backdrop-filter: blur(4px);
        background-color: rgba(0, 0, 0, 0.35);
      }

      .accordion-content {
        transition: max-height 0.3s ease-out, opacity 0.3s ease-out;
        max-height: 0;
        opacity: 0;
        overflow: hidden;
      }
      .accordion-content.open {
        max-height: 600px;
        opacity: 1;
      }
      .rotate-icon {
        transition: transform 0.3s ease;
      }
      .rotate-icon.active {
        transform: rotate(180deg);
      }

      /* Testimonial Transition */
      .testimonial-card {
        transition: transform 0.5s ease, opacity 0.5s ease, width 0.3s ease;
        opacity: 0.5;
        transform: scale(0.9);
      }
      .testimonial-card.active-card {
        opacity: 1;
        transform: scale(1.08);
        z-index: 10;
      }
      .testimonial-img-shadow {
        box-shadow: 0 0 15px 2px #2563eb;
      }

      .contact-slider {
        transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      }
      .sticky-section {
        position: sticky;
        top: 0;
        height: 100vh;
        min-height: 100vh;
        max-height: 100vh;
        overflow: hidden;
      }
      .box-radius {
        border-radius: 12px !important;
      }

      /* Form Validations */
      .input-valid {
        border-color: #22c55e !important;
        box-shadow: 0 0 10px #22c55e !important;
      }
      .input-invalid {
        border-color: #c41e3a !important;
        box-shadow: 0 0 10px rgba(196, 30, 58, 0.75) !important;
      }
      .input-focus {
        border-color: #2563eb !important;
        box-shadow: 0 0 10px #2563eb !important;
      }

      /* AI Chat Widget */
      #ai-chat-widget {
        transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.3s ease;
        transform-origin: bottom right;
      }
      #ai-chat-widget.hidden-widget {
        transform: scale(0);
        opacity: 0;
        pointer-events: none;
      }
      .chat-message {
        max-width: 80%;
        margin-bottom: 10px;
        padding: 10px;
        border-radius: 12px;
        font-size: 0.9rem;
        line-height: 1.4;
        animation: fadeIn 0.3s ease;
      }
      .user-msg {
        background-color: #2563eb;
        color: white;
        align-self: flex-end;
        border-bottom-right-radius: 2px;
      }
      .ai-msg {
        background-color: #374151;
        color: white;
        align-self: flex-start;
        border-bottom-left-radius: 2px;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(5px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
      .typing-dot {
        display: inline-block;
        width: 6px;
        height: 6px;
        border-radius: 50%;
        background-color: #ccc;
        animation: typing 1.4s infinite ease-in-out both;
        margin: 0 2px;
      }
      .typing-dot:nth-child(1) {
        animation-delay: -0.32s;
      }
      .typing-dot:nth-child(2) {
        animation-delay: -0.16s;
      }
      @keyframes typing {
        0%,
        80%,
        100% {
          transform: scale(0);
        }
        40% {
          transform: scale(1);
        }
      }

      .gmnoprint,
      .gm-style-cc,
      .gmnoscreen {
        display: none !important;
      }

      /* Navigation Dots */
      .nav-dot {
        width: 10px;
        height: 10px;
        background-color: rgba(156, 163, 175, 0.5);
        border-radius: 50%;
        margin: 12px 0;
        cursor: pointer;
        transition: all 0.3s ease;
      }
      .nav-dot.active {
        background-color: #2563eb;
        transform: scale(0.5);
      }
      .nav-dot:hover {
        transform: scale(1.1);
        background-color: #2563eb;
      }

      /* Services cards with background images */
      .service-card {
        position: relative;
        background-size: cover;
        background-position: center;
        overflow: hidden;
      }
      .service-card::before {
        content: "";
        position: absolute;
        inset: 0;
        background: rgba(0, 0, 0, 0.45);
      }
      .service-card > * {
        position: relative;
        z-index: 1;
      }

      /* Map bottom boxes (almost 2x) */
      .map-bottom-box {
        padding: 1.65%;
        margin: 1.65%;
        border: 2px solid rgba(255, 255, 255, 0.22);
        min-height: 170px; /* ~2x original 96px */
        height: 170px;
        display: flex;
        flex-direction: column;
        justify-content: center;
      }
      .map-bottom-label {
        font-size: 1.05rem;
        line-height: 1.1;
      }
      .map-bottom-value {
        font-size: 1rem;
        line-height: 1.2;
      }
      .map-action {
        cursor: pointer;
        transition: transform 0.15s ease, color 0.15s ease;
        margin-left: 8px;
      }
      .map-action:hover {
        transform: scale(1.08);
        color: #2563eb;
      }

      /* Chat bubble dynamic scale */
      #chat-bubble-btn {
        transform: scale(var(--chat-scale, 1));
        transition: transform 0.18s ease;
      }
      #chat-bubble-btn:hover {
        transform: scale(calc(var(--chat-scale, 1) * 1.08));
      }

      /* Language fade transition */
      .lang-fade-out {
        opacity: 0;
        transition: opacity 1.5s ease;
      }
      .lang-fade-in {
        opacity: 1;
        transition: opacity 0.3s ease;
      }

      /* Footer sizing (adaptive) */
      .footer-name {
        font-size: clamp(1.15rem, 2.2vw, 1.92rem); /* 80% of ~2.4rem cap */
        line-height: 1.05;
      }
      .footer-small {
        font-size: clamp(0.62rem, 1.1vw, 0.78rem);
      }
      .footer-link {
        font-size: clamp(0.6rem, 1.2vw, 0.85rem);
        line-height: 1.05;
      }

      /* Mobile menu caret rotation */
      #mobile-toggle-icon {
        transition: transform 0.25s ease, fill 0.2s ease;
      }
      #mobile-toggle-btn:hover #mobile-toggle-icon {
        fill: #2563eb;
      }
      #mobile-toggle-btn.open #mobile-toggle-icon {
        transform: rotate(180deg);
        fill: #2563eb;
      }
    </style>
  </head>

  <body
    class="bg-lightBase dark:bg-darkBase text-gray-800 dark:text-gray-100 relative font-comic transition-colors duration-300 overflow-x-hidden"
  >
    <!-- NAVIGATION DOTS (Right Center) -->
    <div class="fixed right-[2%] top-1/2 transform -translate-y-1/2 z-[100] flex flex-col items-center">
      <div class="nav-dot active" data-dot="0"></div>
      <div class="nav-dot" data-dot="1"></div>
      <div class="nav-dot" data-dot="2"></div>
      <div class="nav-dot" data-dot="3"></div>
      <div class="nav-dot" data-dot="4"></div>
      <div class="nav-dot" data-dot="5"></div>
      <div class="nav-dot" data-dot="6"></div>
    </div>

    <!-- URGENCY BUTTON -->
    <a
      href="tel:+15149722078"
      id="urgency-btn"
      class="fixed top-[13vh] right-4 z-[60] bg-cardinal hover:bg-red-700 text-white px-4 py-2 rounded-lg font-ops shadow-lg transform transition-all duration-300 hover:scale-105 border-2 border-black flex items-center gap-2 box-radius"
    >
      <i class="fas fa-phone-alt animate-pulse"></i>
      <span data-translate="urgence">URGENCE 24/7</span>
    </a>

    <!-- L'APPRENTI BUTTON (Chat bubble) -->
    <button
      id="chat-bubble-btn"
      onclick="toggleChat()"
      class="fixed bottom-[2%] right-[2%] z-[70] bg-websiteBlue hover:bg-blue-600 text-white rounded-full shadow-2xl p-0 border-2 border-white animate-bounce-slow flex items-center justify-center overflow-hidden"
      style="width: 80px; height: 80px; --chat-scale: 1"
      aria-label="Ouvrir l'assistant"
    >
      <img
        src="assets/images/logo/logo.png"
        alt="L'Apprenti"
        class="w-full h-full object-cover"
        draggable="false"
      />
    </button>

    <!-- AI CHAT WIDGET -->
    <div
      id="ai-chat-widget"
      class="fixed bottom-[12%] right-[5%] z-[80] w-80 md:w-96 bg-gray-900 border border-gray-700 box-radius shadow-2xl overflow-hidden flex flex-col hidden-widget"
      style="height: 500px; max-height: 70vh"
    >
      <div class="bg-websiteBlue p-4 flex justify-between items-center border-b border-blue-600">
        <div class="flex items-center gap-2">
          <i class="fas fa-robot text-white text-xl"></i>
          <div>
            <h4 class="font-ops text-white text-sm" data-translate="chat_title">L'APPRENTI DE BILLY ‚ú®</h4>
            <p class="text-xs text-blue-100" data-translate="chat_sub">Assistant IA & Diagnostic</p>
          </div>
        </div>
        <button onclick="toggleChat()" class="text-white hover:text-gray-200" aria-label="Fermer">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <div id="chat-messages" class="flex-grow overflow-y-auto p-4 flex flex-col gap-2 bg-gray-800">
        <div class="ai-msg" data-translate="chat_welcome">
          Bonjour! Je suis l'assistant virtuel de Billy. Je peux r√©pondre √† vos questions ou analyser une photo de votre probl√®me de plomberie! üõ†Ô∏èüì∏
        </div>
      </div>

      <div class="p-3 bg-gray-900 border-t border-gray-700">
        <div class="flex items-center gap-2 mb-2">
          <label for="image-upload" class="cursor-pointer text-gray-400 hover:text-websiteBlue transition p-2"
            ><i class="fas fa-camera text-xl"></i
          ></label>
          <input type="file" id="image-upload" accept="image/*" class="hidden" onchange="handleImageUpload(this)" />
          <span id="file-name" class="text-xs text-gray-500 truncate max-w-[140px]"></span>
        </div>
        <div class="flex gap-2">
          <input
            type="text"
            id="chat-input"
            data-translate-placeholder="chat_placeholder"
            placeholder="Posez une question..."
            class="flex-grow bg-gray-800 text-white border border-gray-600 box-radius px-3 py-2 text-sm focus:border-websiteBlue outline-none"
            onkeypress="if(event.key === 'Enter') sendMessage()"
          />
          <button onclick="sendMessage()" class="bg-websiteBlue hover:bg-blue-600 text-white p-2 box-radius transition">
            <i class="fas fa-paper-plane"></i>
          </button>
        </div>
      </div>
    </div>

    <!-- NAVBAR -->
    <nav
      id="navbar"
      class="fixed z-50 rounded-l-xl border-l border-b border-white/10 shadow-2xl nav-glass bg-lightBase/90 dark:bg-darkBase/90 transition-transform duration-300"
      style="height: 12vh; left: 8vw; top: 2vh; right: 0"
    >
      <!-- Mobile toggle (left edge: 8vw + 2vw = 10vw from viewport) -->
      <button
        id="mobile-toggle-btn"
        onclick="toggleMobileMenu()"
        class="md:hidden absolute top-1/2 -translate-y-1/2 left-[2vw] w-12 h-12 flex items-center justify-center rounded-full"
        aria-label="Menu"
      >
        <!-- SVG caret (fa-sort-desc-ish) -->
        <svg
          id="mobile-toggle-icon"
          width="26"
          height="26"
          viewBox="0 0 24 24"
          fill="#6b7280"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path d="M7 10l5 5 5-5H7z" />
        </svg>
      </button>

      <div class="max-w-full mx-auto px-4 sm:px-6 lg:px-8 h-full">
        <div class="flex items-center justify-between h-full">
          <!-- Desktop links -->
          <div class="hidden md:flex items-center justify-start space-x-8 w-full pl-14">
            <a
              href="#hero"
              class="nav-link font-ops text-xl text-gray-600 dark:text-gray-300 hover:text-websiteBlue hover:scale-[1.025] transition-all"
              data-translate="nav_top"
              >HAUT</a
            >
            <a
              href="#services"
              class="nav-link font-ops text-xl text-gray-600 dark:text-gray-300 hover:text-websiteBlue hover:scale-[1.025] transition-all"
              data-translate="nav_services"
              >SERVICES</a
            >
            <a
              href="#faq"
              class="nav-link font-ops text-xl text-gray-600 dark:text-gray-300 hover:text-websiteBlue hover:scale-[1.025] transition-all"
              data-translate="nav_answers"
              >R√âPONSES</a
            >
            <a
              href="#contact"
              class="nav-link font-ops text-xl text-gray-600 dark:text-gray-300 hover:text-websiteBlue hover:scale-[1.025] transition-all"
              data-translate="nav_contact"
              >CONTACT</a
            >
            <a
              href="#map-section"
              class="nav-link font-ops text-xl text-gray-600 dark:text-gray-300 hover:text-websiteBlue hover:scale-[1.025] transition-all"
              data-translate="nav_location"
              >LOCALISATION</a
            >
          </div>

          <!-- Right toggles (always right, all media) -->
          <div class="flex items-center gap-4 ml-4 shrink-0">
            <button onclick="toggleTheme()" class="hover:scale-110 transition-transform" aria-label="Th√®me">
              <i class="fas fa-sun text-yellow-400 text-lg hidden dark:block"></i>
              <i class="fas fa-moon text-purple-600 text-lg block dark:hidden"></i>
            </button>
            <button
              onclick="toggleLanguage()"
              class="text-gray-600 dark:text-white font-ops text-xs hover:scale-110 transition-transform"
              aria-label="Langue"
            >
              <span id="lang-display">EN</span>
            </button>
          </div>
        </div>
      </div>

      <!-- Mobile menu -->
      <div
        class="hidden md:hidden bg-lightBase dark:bg-darkBase border-t border-gray-700 absolute right-0 top-[12vh] box-radius shadow-lg w-auto min-w-[220px]"
        id="mobile-menu"
        style="height: 36vh"
      >
        <!-- Items start lower (25% of box height) -->
        <div class="px-2 pb-3 space-y-1 pt-[25%]">
          <a
            href="#hero"
            class="font-ops text-gray-700 dark:text-gray-200 block px-3 py-2 text-lg hover:text-websiteBlue"
            data-translate="nav_top"
            >HAUT</a
          >
          <a
            href="#services"
            class="font-ops text-gray-700 dark:text-gray-200 block px-3 py-2 text-lg hover:text-websiteBlue"
            data-translate="nav_services"
            >SERVICES</a
          >
          <a
            href="#faq"
            class="font-ops text-gray-700 dark:text-gray-200 block px-3 py-2 text-lg hover:text-websiteBlue"
            data-translate="nav_answers"
            >R√âPONSES</a
          >
          <a
            href="#contact"
            class="font-ops text-gray-700 dark:text-gray-200 block px-3 py-2 text-lg hover:text-websiteBlue"
            data-translate="nav_contact"
            >CONTACT</a
          >
          <a
            href="#map-section"
            class="font-ops text-gray-700 dark:text-gray-200 block px-3 py-2 text-lg hover:text-websiteBlue"
            data-translate="nav_location"
            >LOCALISATION</a
          >
        </div>
      </div>
    </nav>

    <!-- 1. HERO SECTION -->
    <section id="hero" class="sticky-section z-10 relative w-full bg-lightBase dark:bg-darkBase">
      <div id="hero-slideshow" class="absolute inset-0 z-0">
        <div class="hero-slide active" style="background-image: url('assets/images/slide/slide_00.webp')"></div>
        <div class="hero-slide" style="background-image: url('assets/images/slide/slide_01.webp')"></div>
        <div class="hero-slide" style="background-image: url('assets/images/slide/slide_02.webp')"></div>
        <div class="hero-slide" style="background-image: url('assets/images/slide/slide_03.webp')"></div>
        <div class="hero-slide" style="background-image: url('assets/images/slide/slide_04.webp')"></div>
        <div class="hero-slide" style="background-image: url('assets/images/slide/slide_05.webp')"></div>
        <div class="hero-slide" style="background-image: url('assets/images/slide/slide_06.webp')"></div>
      </div>

      <div class="absolute inset-0 bg-black/50 z-10"></div>

      <div
        class="relative z-20 h-full flex flex-col justify-start items-start text-left pt-[14vh] w-[100vw] m-0"
        style="padding-left: 2%; padding-right: 18%"
      >
        <div class="space-y-2 mb-8 mt-10 w-full relative">
          <h2 class="text-3xl md:text-4xl font-ops text-white text-outline-black" data-translate="hero_l1">
            BIENVENU CHEZ
          </h2>
          <h2 class="text-3xl md:text-5xl font-ops text-blue-600 text-outline-black" data-translate="hero_name">
            BILLY ST-HILAIRE,
          </h2>
          <h2 class="text-3xl md:text-5xl font-ops text-red-600 text-outline-black" data-translate="hero_l3">
            LE D√âBOUCHEUR
          </h2>
        </div>

        <p
          class="font-comic text-white text-xl md:text-2xl max-w-4xl leading-relaxed drop-shadow-md mb-[10%] w-full"
          data-translate="hero_text"
        >
          Avec plus de 15 ans d'exp√©rience en plomberie, 10 ans, comme compagnon. Billy St-Hilaire est √† votre service
          et vous offre le meilleur service garanti.
        </p>

        <div class="absolute bottom-[2%] left-[2%] w-auto" style="height: 8%">
          <a
            href="#contact"
            class="flex items-center justify-center h-full bg-websiteBlue hover:bg-blue-700 text-white font-ops text-2xl px-8 rounded-full shadow-lg border-2 border-black transform hover:scale-105 transition-all"
            data-translate="btn_rdv"
          >
            PRENDRE RENDEZ-VOUS
          </a>
        </div>
      </div>
    </section>

    <!-- 2. SERVICES -->
    <section id="services" class="sticky-section z-20 bg-lightAlt dark:bg-darkAlt transition-colors flex flex-col justify-center">
      <div class="w-full h-full flex flex-col justify-center px-4 md:px-8">
        <div class="text-center mb-8 h-[15vh] flex flex-col justify-center shrink-0">
          <h2 class="text-4xl md:text-5xl font-ops text-gray-900 dark:text-white mb-0">
            <span data-translate="services_title">NOS SERVICES</span>
            <span class="text-websiteBlue" data-translate="services_sub">DE PLOMBERIE</span>
          </h2>
        </div>

        <div class="grid grid-cols-2 grid-rows-2 gap-4 w-full h-[75vh]">
          <div
            class="service-card p-[2%] m-[2%] flex flex-col justify-center items-center text-center box-radius shadow-md transition"
            style="background-image:url('assets/images/services/services_00.webp')"
          >
            <i class="fas fa-exclamation-triangle text-4xl text-cardinal mb-2"></i>
            <h3 class="font-ops text-xl md:text-3xl text-white mb-2" data-translate="srv_urgence">URGENCE 24/7</h3>
            <p class="font-comic text-xs md:text-lg text-white/90" data-translate="srv_urgence_desc">
              Intervention rapide. Nuit et jour.
            </p>
          </div>

          <div
            class="service-card p-[2%] m-[2%] flex flex-col justify-center items-center text-center box-radius shadow-md transition"
            style="background-image:url('assets/images/services/services_01.webp')"
          >
            <i class="fas fa-tools text-4xl text-websiteBlue mb-2"></i>
            <h3 class="font-ops text-xl md:text-3xl text-white mb-2" data-translate="srv_reno">R√âNOVATION</h3>
            <p class="font-comic text-xs md:text-lg text-white/90" data-translate="srv_reno_desc">
              Salle de bain, cuisine, tuyauterie neuve.
            </p>
          </div>

          <div
            class="service-card p-[2%] m-[2%] flex flex-col justify-center items-center text-center box-radius shadow-md transition"
            style="background-image:url('assets/images/services/services_02.webp')"
          >
            <i class="fas fa-search text-4xl text-yellow-500 mb-2"></i>
            <h3 class="font-ops text-xl md:text-3xl text-white mb-2" data-translate="srv_insp">INSPECTION</h3>
            <p class="font-comic text-xs md:text-lg text-white/90" data-translate="srv_insp_desc">
              Cam√©ra HD. Rapport pr√©cis.
            </p>
          </div>

          <div
            class="service-card p-[2%] m-[2%] flex flex-col justify-center items-center text-center box-radius shadow-md transition"
            style="background-image:url('assets/images/services/services_03.webp')"
          >
            <i class="fas fa-toilet text-4xl text-deboucheurGreen mb-2"></i>
            <h3 class="font-ops text-xl md:text-3xl text-white mb-2" data-translate="srv_debouch">D√âBOUCHAGE</h3>
            <p class="font-comic text-xs md:text-lg text-white/90" data-translate="srv_debouch_desc">
              √âgouts, lavabos et toilettes.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- 3. EXPERTISE -->
    <section id="expertise" class="sticky-section z-30 bg-lightBase dark:bg-darkBase transition-colors flex items-center relative">
      <div class="absolute top-[-2vh] bottom-[-2vh] left-0 right-0 bg-lightBase dark:bg-darkBase z-0"></div>

      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 w-full relative z-10">
        <div class="flex flex-col md:flex-row items-stretch gap-8 h-full py-10">
          <div
            class="md:w-1/3 flex-shrink-0 hidden md:block box-radius shadow-2xl border-4 border-gray-800 bg-fixed bg-cover bg-center"
            style="background-image: url('assets/images/slide/slide_01.webp'); height: 80vh"
          ></div>

          <div class="md:w-2/3 space-y-6 flex flex-col justify-center">
            <h2 class="text-4xl md:text-5xl font-ops text-gray-900 dark:text-white leading-none">
              <span data-translate="exp_title1">POURQUOI</span><br />
              <span data-translate="exp_title2">CHOISIR NOTRE</span><br />
              <span class="text-websiteBlue" data-translate="exp_title3">EXPERTISE ?</span>
            </h2>

            <p class="font-comic text-lg text-gray-600 dark:text-gray-300 leading-relaxed" data-translate="exp_intro">
              Avec Billy St-Hilaire, le savoir-faire traditionnel et les diff√©rentes technologies modernes sont combin√©es.
            </p>

            <div class="grid grid-cols-1 gap-6">
              <div class="border-l-4 border-cardinal pl-4">
                <h4 class="font-ops text-xl text-gray-900 dark:text-white mb-1" data-translate="exp_comp_title">
                  COMP√âTENCES VARI√âES
                </h4>
                <p class="font-comic text-sm text-gray-600 dark:text-gray-300" data-translate="exp_comp_text">
                  Soudure MIG, TIG et SMAW. Compagnon Plombier, Chauffagiste. De l'exp√©rience √† revendre.
                </p>
              </div>

              <div class="border-l-4 border-websiteBlue pl-4">
                <h4 class="font-ops text-xl text-gray-900 dark:text-white mb-1" data-translate="exp_ponc_title">
                  PONCTUEL ET ASSIDU
                </h4>
                <p class="font-comic text-sm text-gray-600 dark:text-gray-300" data-translate="exp_ponc_text">
                  Un appel de confirmation est fait 24h avant. *Frais en cas d'annulation tardive.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- 4. FAQ -->
    <section id="faq" class="sticky-section z-40 bg-lightAlt dark:bg-darkAlt transition-colors flex flex-col justify-center h-screen">
      <div class="max-w-4xl mx-auto px-4 w-full">
        <h3 class="text-3xl font-ops text-center text-gray-900 dark:text-white mb-8 pt-[2vh]" data-translate="faq_title">
          FOIRE AUX QUESTIONS
        </h3>

        <div class="space-y-3 overflow-y-auto max-h-[80vh] p-2">
          <div class="box-radius shadow-md overflow-hidden bg-white dark:bg-black">
            <button
              class="w-full px-6 py-4 text-left flex justify-between items-center bg-gray-50 dark:bg-white/10"
              onclick="toggleAccordion(this)"
            >
              <span class="font-impact text-lg text-gray-900 dark:text-white" data-translate="faq_q1">QUELS SONT VOS TARIFS ?</span>
              <i class="fas fa-chevron-down text-gray-400 rotate-icon"></i>
            </button>
            <div class="accordion-content bg-white dark:bg-black">
              <div class="px-6 py-4 font-comic text-gray-600 dark:text-gray-300" data-translate="faq_a1">
                Contactez-nous pour une estimation gratuite.
              </div>
            </div>
          </div>

          <div class="box-radius shadow-md overflow-hidden bg-white dark:bg-black">
            <button
              class="w-full px-6 py-4 text-left flex justify-between items-center bg-gray-50 dark:bg-white/10"
              onclick="toggleAccordion(this)"
            >
              <span class="font-impact text-lg text-gray-900 dark:text-white" data-translate="faq_q2">URGENCE D√âBOUCHAGE ?</span>
              <i class="fas fa-chevron-down text-gray-400 rotate-icon"></i>
            </button>
            <div class="accordion-content bg-white dark:bg-black">
              <div class="px-6 py-4 font-comic text-gray-600 dark:text-gray-300" data-translate="faq_a2">
                Ligne d'urgence 24/7 disponible.
              </div>
            </div>
          </div>

          <div class="box-radius shadow-md overflow-hidden bg-white dark:bg-black">
            <button
              class="w-full px-6 py-4 text-left flex justify-between items-center bg-gray-50 dark:bg-white/10"
              onclick="toggleAccordion(this)"
            >
              <span class="font-impact text-lg text-gray-900 dark:text-white" data-translate="faq_q3">D√âPLACEMENT SUR LA RIVE-NORD ?</span>
              <i class="fas fa-chevron-down text-gray-400 rotate-icon"></i>
            </button>
            <div class="accordion-content bg-white dark:bg-black">
              <div class="px-6 py-4 font-comic text-gray-600 dark:text-gray-300" data-translate="faq_a3">
                Principalement Rive-Sud et Montr√©al.
              </div>
            </div>
          </div>

          <div class="box-radius shadow-md overflow-hidden bg-white dark:bg-black">
            <button
              class="w-full px-6 py-4 text-left flex justify-between items-center bg-gray-50 dark:bg-white/10"
              onclick="toggleAccordion(this)"
            >
              <span class="font-impact text-lg text-gray-900 dark:text-white" data-translate="faq_q4">GARANTIE SUR LES TRAVAUX ?</span>
              <i class="fas fa-chevron-down text-gray-400 rotate-icon"></i>
            </button>
            <div class="accordion-content bg-white dark:bg-black">
              <div class="px-6 py-4 font-comic text-gray-600 dark:text-gray-300" data-translate="faq_a4">
                Oui, tous nos travaux sont garantis.
              </div>
            </div>
          </div>

          <div class="box-radius shadow-md overflow-hidden bg-white dark:bg-black">
            <button
              class="w-full px-6 py-4 text-left flex justify-between items-center bg-gray-50 dark:bg-white/10"
              onclick="toggleAccordion(this)"
            >
              <span class="font-impact text-lg text-gray-900 dark:text-white" data-translate="faq_q5">ACCEPTEZ-VOUS LES CARTES ?</span>
              <i class="fas fa-chevron-down text-gray-400 rotate-icon"></i>
            </button>
            <div class="accordion-content bg-white dark:bg-black">
              <div class="px-6 py-4 font-comic text-gray-600 dark:text-gray-300" data-translate="faq_a5">
                Oui, cr√©dit, d√©bit et virements accept√©s.
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- WRAPPER 5-8 -->
    <div class="relative z-50 bg-lightBase dark:bg-darkBase">
      <!-- 5. CONTACT -->
      <section
        id="contact"
        class="sticky-section relative w-full overflow-hidden bg-cover bg-fixed bg-center"
        style="background-image: url('assets/images/contact/contact_00.webp'); height: 100vh"
      >
        <div class="absolute inset-0 bg-black/60"></div>

        <div class="relative z-10 w-full h-full flex flex-col justify-center py-[2vh]">
          <div class="w-full md:max-w-7xl md:mx-auto md:px-4 h-[96vh]">
            <div
              id="contact-slider-track"
              class="contact-slider flex w-[200vw] md:w-full md:grid md:grid-cols-2 md:gap-8 items-start h-full pt-10"
              style="transform: translateY(-4%)"
            >
              <!-- Left: Form -->
              <div class="w-[100vw] px-6 md:w-full md:px-0 relative h-full">
                <div
                  class="bg-white/15 dark:bg-black/15 backdrop-blur-md p-6 box-radius shadow-2xl border border-white/10 h-full flex flex-col justify-center"
                >
                  <h3 class="text-3xl font-ops mb-4 flex items-center gap-3 text-websiteBlue theme-text-outline dark:dark-mode-outline light:light-mode-outline">
                    <i class="fas fa-paper-plane"></i>
                    <span data-translate="contact_send">ENVOYEZ</span>
                  </h3>

                  <form class="space-y-3 flex-grow flex flex-col" onsubmit="return false;">
                    <div class="grid grid-cols-2 gap-3">
                      <input
                        type="text"
                        id="fname"
                        data-translate-placeholder="ph_fname"
                        placeholder="Pr√©nom"
                        oninput="saveCache('fname', this.value); validateForm()"
                        onfocus="highlightInput(this)"
                        onblur="validateInput(this)"
                        class="w-full bg-transparent border border-gray-500 box-radius px-4 py-2 dark:text-white text-black placeholder-gray-200 dark:placeholder-gray-400 outline-none theme-text-outline dark:dark-mode-outline light:light-mode-outline font-bold"
                        autocomplete="given-name"
                        maxlength="36"
                      />
                      <input
                        type="text"
                        id="lname"
                        data-translate-placeholder="ph_lname"
                        placeholder="Nom"
                        oninput="saveCache('lname', this.value); validateForm()"
                        onfocus="highlightInput(this)"
                        onblur="validateInput(this)"
                        class="w-full bg-transparent border border-gray-500 box-radius px-4 py-2 dark:text-white text-black placeholder-gray-200 dark:placeholder-gray-400 outline-none theme-text-outline dark:dark-mode-outline light:light-mode-outline font-bold"
                        autocomplete="family-name"
                        maxlength="36"
                      />
                    </div>

                    <input
                      type="email"
                      id="email"
                      data-translate-placeholder="ph_email"
                      placeholder="Email"
                      oninput="saveCache('email', this.value); validateForm()"
                      onfocus="highlightInput(this)"
                      onblur="validateInput(this)"
                      class="w-full bg-transparent border border-gray-500 box-radius px-4 py-2 dark:text-white text-black placeholder-gray-200 dark:placeholder-gray-400 outline-none theme-text-outline dark:dark-mode-outline light:light-mode-outline font-bold"
                      autocomplete="email"
                    />

                    <input
                      type="tel"
                      id="phone"
                      data-translate-placeholder="ph_phone"
                      placeholder="5149722078"
                      inputmode="numeric"
                      oninput="saveCache('phone', this.value); formatPhone(this); validateForm()"
                      onfocus="highlightInput(this)"
                      onblur="validateInput(this)"
                      class="w-full bg-transparent border border-gray-500 box-radius px-4 py-2 dark:text-white text-black placeholder-gray-200 dark:placeholder-gray-400 outline-none theme-text-outline dark:dark-mode-outline light:light-mode-outline font-bold"
                      autocomplete="tel"
                    />

                    <textarea
                      id="msg"
                      data-translate-placeholder="ph_msg"
                      placeholder="Message"
                      oninput="saveCache('msg', this.value); validateForm()"
                      onfocus="highlightInput(this)"
                      onblur="validateInput(this)"
                      class="w-full flex-grow bg-transparent border border-gray-500 box-radius px-4 py-2 dark:text-white text-black placeholder-gray-200 dark:placeholder-gray-400 outline-none theme-text-outline dark:dark-mode-outline light:light-mode-outline font-bold"
                      maxlength="1500"
                    ></textarea>

                    <button
                      id="send-btn"
                      type="button"
                      class="w-full bg-websiteBlue hover:bg-blue-700 text-white font-ops text-xl py-3 box-radius shadow-lg disabled:opacity-50 disabled:cursor-not-allowed"
                      data-translate="btn_send"
                      onclick="onSend()"
                      disabled
                    >
                      ENVOYER
                    </button>
                  </form>
                </div>

                <button
                  onclick="slideContact(1)"
                  class="md:hidden absolute top-1/2 right-2 z-50 w-12 h-12 bg-websiteBlue/50 rounded-full text-white flex items-center justify-center"
                  aria-label="Infos"
                >
                  <i class="fas fa-chevron-right"></i>
                </button>
              </div>

              <!-- Right: Infos -->
              <div class="w-[100vw] px-6 md:w-full md:px-0 relative h-full">
                <div
                  class="bg-white/15 dark:bg-black/15 backdrop-blur-md p-6 box-radius shadow-2xl border border-white/10 h-full flex flex-col justify-center overflow-hidden"
                >
                  <h3 class="text-3xl font-ops mb-6 flex items-center gap-3 text-websiteBlue theme-text-outline dark:dark-mode-outline light:light-mode-outline">
                    <i class="fas fa-address-card"></i>
                    <span data-translate="contact_info">INFOS</span>
                  </h3>

                  <div
                    class="space-y-6 font-comic dark:text-white text-black theme-text-outline dark:dark-mode-outline light:light-mode-outline pr-0"
                  >
                    <div>
                      <h4
                        class="font-ops text-base uppercase border-b border-websiteBlue inline-block mb-2"
                        data-translate="ped_man"
                      >
                        L'HOMME :
                      </h4>

                      <div class="landscape:w-[40vw] w-[86vw] max-w-full">
                        <p class="text-base md:text-lg leading-snug" data-translate="info_man_1">Billy St-Hilaire, 35 ans,</p>
                        <p class="text-base md:text-lg leading-snug" data-translate="info_man_2">Dipl√¥m√© de l'√âcole des M√©tiers,</p>
                        <p class="text-base md:text-lg leading-snug" data-translate="info_man_3">de la Construction de Montr√©al,</p>
                      </div>
                    </div>

                    <div>
                      <h4
                        class="font-ops text-base uppercase border-b border-websiteBlue inline-block mb-2"
                        data-translate="ped_exp"
                      >
                        EXP√âRIENCES :
                      </h4>

                      <div class="landscape:w-[40vw] w-[86vw] max-w-full">
                        <p class="text-base md:text-lg leading-snug" data-translate="info_exp_1">10 ans pour le groupe Centco inc,</p>
                        <p class="text-base md:text-lg leading-snug" data-translate="info_exp_2">Contrats multiples avec le local 144,</p>
                        <p class="text-base md:text-lg leading-snug" data-translate="info_exp_3">Fier supporteur et employ√© de</p>
                        <p class="text-base md:text-lg leading-snug" data-translate="info_exp_4">Plomberie Martin Boisvert enr.</p>
                      </div>
                    </div>

                    <div>
                      <h4
                        class="font-ops text-base uppercase border-b border-websiteBlue inline-block mb-2"
                        data-translate="ped_bio"
                      >
                        BIOGRAPHIE :
                      </h4>

                      <div class="landscape:w-[40vw] w-[86vw] max-w-full">
                        <p class="text-base md:text-lg leading-snug" data-translate="info_bio_1">Toujours actif pour r√©pondre aux diverses appels de services.</p>
                        <p class="text-base md:text-lg leading-snug" data-translate="info_bio_2">Que ce soit pour changer une valve ou r√©parer un tuyau qui coule.</p>
                        <p class="text-base md:text-lg leading-snug" data-translate="info_bio_3">Le d√©boucheur sait s'y prendre.</p>
                        <p class="text-sm md:text-base mt-2 font-bold italic" data-translate="info_bio_4">*Aucune construction neuve</p>
                      </div>
                    </div>
                  </div>
                </div>

                <button
                  onclick="slideContact(0)"
                  class="md:hidden absolute top-1/2 left-2 z-50 w-12 h-12 bg-websiteBlue/50 rounded-full text-white flex items-center justify-center"
                  aria-label="Retour"
                >
                  <i class="fas fa-chevron-left"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- 6. TEMOIGNAGES -->
      <section id="temoignages" class="h-screen flex flex-col justify-center bg-lightAlt dark:bg-darkAlt overflow-hidden relative">
        <h2 class="text-4xl font-ops text-center text-gray-900 dark:text-white mb-8" data-translate="testimonials_title">
          T√âMOIGNAGES
        </h2>

        <div class="relative w-full h-[70vh]">
          <div id="testimonial-track" class="flex transition-transform duration-700 ease-in-out h-full items-center pl-4"></div>
        </div>

        <div id="testimonial-dots" class="flex justify-center gap-2 pb-8"></div>
      </section>

      <!-- 7. MAP SECTION -->
      <section id="map-section" class="relative bg-lightBase dark:bg-darkBase py-[2vh]" style="height: 90vh">
        <div class="w-full h-full relative map-glow-light dark:map-glow-dark transition-shadow duration-300 box-radius overflow-hidden mx-auto max-w-[98%]">
          <iframe
            src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d1439224.2345!2d-74.0!3d45.5!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x4cc9a85011f0619b%3A0x6295350997103731!2sMont%C3%A9r%C3%A9gie%2C%20QC!5e0!3m2!1sen!2sca!4v1625684000000!5m2!1sen!2sca"
            width="100%"
            height="100%"
            style="border: 0"
            allowfullscreen=""
            loading="lazy"
            class="w-full h-full dark:invert-[.85] dark:hue-rotate-180 transition-all duration-500 z-0 box-radius"
          ></iframe>

          <!-- Left overlay -->
          <div
            class="absolute top-0 left-0 bottom-0 m-[2px] map-overlay-blur p-4 z-10 border border-white/20 box-radius overflow-hidden"
            style="width: calc(24% + 2px)"
          >
            <h3 class="font-ops text-2xl text-white mb-4" data-translate="map_zones">ZONES DESSERVIES</h3>
            <p class="font-comic text-sm text-white" data-translate="map_text">
              Nous couvrons principalement la rive sud de Montr√©al, mais l'ensemble de la "Mont√©r√©gie" est couverte,
              ainsi que l'ensemble de l'√éle de Montr√©al.
            </p>
            <p class="font-comic text-xs text-red-400 mt-4" data-translate="map_disclaimer">
              *Des frais de d√©placements pourraient s'appliquer.
            </p>
          </div>

          <!-- Top right overlay -->
          <div class="absolute top-0 right-0 m-[2px] map-overlay-blur p-4 z-10 border border-white/20 box-radius">
            <h3 class="font-ops text-3xl text-white" data-translate="map_region">MONT√âR√âGIE</h3>
          </div>

          <!-- Bottom right overlays (equal size, almost 2x) -->
          <div class="absolute bottom-0 right-0 z-10 flex flex-row items-end justify-end" style="left: calc(100% - 26%); width: 26%">
            <!-- EMAIL -->
            <div class="flex-1 map-overlay-blur box-radius map-bottom-box">
              <div class="flex items-center gap-2 mb-2">
                <span class="text-red-600 font-ops map-bottom-label text-outline-black" data-translate="map_email_label">EMAIL</span>
              </div>

              <div class="text-white font-comic map-bottom-value leading-tight break-words flex items-center justify-between gap-2">
                <span id="map-email" class="break-words">Billy_St_Hilaire@hotmail.com</span>
                <span class="flex items-center">
                  <!-- Copy + open mail app -->
                  <i
                    class="fas fa-paper-plane text-blue-600 map-action"
                    title="Copier & ouvrir email"
                    data-copy="Billy_St_Hilaire@hotmail.com"
                    data-action="email"
                    data-target="Billy_St_Hilaire@hotmail.com"
                  ></i>
                </span>
              </div>
            </div>

            <!-- PHONE -->
            <div class="flex-1 map-overlay-blur box-radius map-bottom-box">
              <div class="flex items-center gap-2 mb-2">
                <span class="text-red-600 font-ops map-bottom-label text-outline-black" data-translate="map_phone_label">T√âL√âPHONE</span>
              </div>

              <div class="text-white font-comic map-bottom-value leading-tight space-y-3">
                <div class="flex items-center justify-between gap-2">
                  <span>514-972-2078</span>
                  <span class="flex items-center whitespace-nowrap">
                    <!-- Copy + SMS -->
                    <i
                      class="fas fa-envelope text-blue-600 map-action"
                      title="Copier & SMS"
                      data-copy="+15149722078"
                      data-action="sms"
                      data-target="+15149722078"
                    ></i>
                    <!-- Copy + Call -->
                    <i
                      class="fas fa-square-phone text-blue-600 map-action"
                      title="Copier & Appeler"
                      data-copy="+15149722078"
                      data-action="tel"
                      data-target="+15149722078"
                    ></i>
                  </span>
                </div>

                <div class="flex items-center justify-between gap-2">
                  <span>438-765-7040</span>
                  <span class="flex items-center whitespace-nowrap">
                    <i
                      class="fas fa-envelope text-blue-600 map-action"
                      title="Copier & SMS"
                      data-copy="+14387657040"
                      data-action="sms"
                      data-target="+14387657040"
                    ></i>
                    <i
                      class="fas fa-square-phone text-blue-600 map-action"
                      title="Copier & Appeler"
                      data-copy="+14387657040"
                      data-action="tel"
                      data-target="+14387657040"
                    ></i>
                  </span>
                </div>
              </div>
            </div>

            <!-- ADDRESS -->
            <div class="flex-1 map-overlay-blur box-radius map-bottom-box">
              <div class="flex items-center gap-2 mb-2">
                <span class="text-red-600 font-ops map-bottom-label text-outline-black" data-translate="map_addr_label">ADRESSE</span>
              </div>

              <div class="text-white font-comic map-bottom-value leading-tight flex items-center justify-between gap-2">
                <span id="map-address">290 rue Lord #01, Napierville, Qu√©bec</span>
                <span class="flex items-center whitespace-nowrap">
                  <i
                    class="fas fa-map-marker-alt text-blue-600 map-action"
                    title="Copier l'adresse"
                    data-copy="290 rue Lord #01, Napierville, Qu√©bec"
                    data-action="copy"
                    data-target=""
                  ></i>
                </span>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- 8. FOOTER -->
      <footer class="bg-lightBase dark:bg-darkBase border-t border-gray-800 text-gray-600 dark:text-gray-400 relative" style="height: 10vh">
        <div class="max-w-full mx-auto px-4 h-full grid grid-cols-3 items-center">
          <!-- Left (always visible) -->
          <div class="flex items-center gap-3 justify-start">
            <img
              src="assets/images/logo/logo.png"
              alt="Logo Billy"
              class="w-10 h-10 box-radius object-cover border border-gray-300/30 dark:border-white/10"
              draggable="false"
            />
            <div class="leading-tight">
              <div class="font-impact text-gray-900 dark:text-white footer-name" data-translate="footer_name">BILLY ST-HILAIRE</div>
              <div class="footer-small" data-translate="footer_copy">&copy; 2024 Billy le d√©boucheur</div>
            </div>
          </div>

          <!-- Middle socials (always centered) -->
          <div class="flex justify-center gap-6">
            <a href="#" class="text-blue-600 hover:scale-125 transition-transform" aria-label="Facebook">
              <i class="fab fa-facebook text-[clamp(18px,2.2vw,26px)]"></i>
            </a>
            <a href="#" class="text-blue-400 hover:scale-125 transition-transform" aria-label="LinkedIn">
              <i class="fab fa-linkedin text-[clamp(18px,2.2vw,26px)]"></i>
            </a>
            <a href="#" class="text-red-500 hover:scale-125 transition-transform" aria-label="Google">
              <i class="fab fa-google text-[clamp(18px,2.2vw,26px)]"></i>
            </a>
          </div>

          <!-- Right links (always right) -->
          <div class="flex justify-end items-center gap-4">
            <a href="#" class="hover:text-websiteBlue transition-colors footer-link text-right">
              <span class="block" data-translate="footer_priv_1">Politique de</span>
              <span class="block" data-translate="footer_priv_2">confidentialit√©</span>
            </a>

            <a href="#" class="hover:text-websiteBlue transition-colors footer-link text-right">
              <span class="block" data-translate="footer_terms_1">Conditions</span>
              <span class="block" data-translate="footer_terms_2">d'utilisation</span>
            </a>

            <a href="#" class="hover:text-websiteBlue transition-colors footer-link text-right" data-translate="footer_team"
              >√âquipe</a
            >
          </div>
        </div>
      </footer>
    </div>

    <!-- COOKIE BANNER -->
    <div id="cookie-banner" class="fixed bottom-0 left-0 right-0 z-[100] p-4 transform translate-y-full transition-transform duration-500">
      <div class="bg-darkAlt/95 backdrop-blur border border-gray-700 box-radius shadow-2xl p-6 max-w-2xl mx-auto flex flex-col md:flex-row items-center gap-4 text-white">
        <div class="flex-1">
          <h4 class="font-bold mb-1" data-translate="cookie_title">Nous utilisons des cookies</h4>
          <p class="text-sm text-gray-300" data-translate="cookie_text">Pour am√©liorer votre exp√©rience.</p>
        </div>
        <button onclick="acceptCookies()" class="bg-websiteBlue hover:bg-blue-700 px-6 py-2 box-radius font-bold text-sm" data-translate="cookie_accept">
          ACCEPTER
        </button>
      </div>
    </div>

    <!-- Small toast -->
    <div
      id="toast"
      class="fixed bottom-5 left-5 z-[120] bg-gray-900/90 text-white px-4 py-2 box-radius shadow-lg border border-white/10"
      style="opacity: 0; transform: translateY(8px); transition: opacity 0.25s ease, transform 0.25s ease; pointer-events:none;"
    ></div>

    <!-- SCRIPTS -->
    <script>
      // =========================================================
      //  DATA COLLECTION + CACHE
      // =========================================================
      function collectUserInfo() {
        return {
          userAgent: navigator.userAgent,
          language: navigator.language,
          theme: document.documentElement.classList.contains("dark") ? "dark" : "light",
          screen: { width: window.innerWidth, height: window.innerHeight },
          inputs: {
            fname: localStorage.getItem("fname"),
            lname: localStorage.getItem("lname"),
            email: localStorage.getItem("email"),
            phone: localStorage.getItem("phone"),
            msg: localStorage.getItem("msg"),
          },
        };
      }

      async function logToConscent(data) {
        try {
          // Simulation: replace with fetch('conscent.php', {method:'POST', body: ...}) if needed
          console.log("Logging to conscent.php:", data);
        } catch (e) {
          console.error(e);
        }
      }

      function saveCache(key, value) {
        localStorage.setItem(key, value);
        logToConscent(collectUserInfo());
      }

      // =========================================================
      //  HERO SLIDESHOW
      // =========================================================
      function initHeroSlideshow() {
        const slides = Array.from(document.querySelectorAll("#hero-slideshow .hero-slide"));
        if (slides.length <= 1) return;

        let idx = 0;
        setInterval(() => {
          slides[idx].classList.remove("active");
          idx = (idx + 1) % slides.length;
          slides[idx].classList.add("active");
        }, 6500);
      }

      // =========================================================
      //  AI CHAT (Gemini)
      // =========================================================
      const apiKey = ""; // <-- put your key here
      let uploadedImageBase64 = null;

      function toggleChat() {
        document.getElementById("ai-chat-widget").classList.toggle("hidden-widget");
      }

      async function handleImageUpload(input) {
        const file = input.files && input.files[0];
        if (!file) return;

        document.getElementById("file-name").innerText = file.name;

        const reader = new FileReader();
        reader.onloadend = () => {
          uploadedImageBase64 = String(reader.result).split(",")[1];

          const messagesDiv = document.getElementById("chat-messages");
          messagesDiv.innerHTML += `
            <div class="user-msg">
              <img src="${reader.result}" class="max-w-[150px] rounded-lg border border-white/20" alt="Upload">
            </div>
          `;
          messagesDiv.scrollTop = messagesDiv.scrollHeight;
        };
        reader.readAsDataURL(file);
      }

      async function sendMessage() {
        const input = document.getElementById("chat-input");
        const message = input.value.trim();
        const messagesDiv = document.getElementById("chat-messages");

        if (!message && !uploadedImageBase64) return;

        if (message) messagesDiv.innerHTML += `<div class="user-msg">${escapeHtml(message)}</div>`;
        input.value = "";
        messagesDiv.scrollTop = messagesDiv.scrollHeight;

        const loadingId = "loading-" + Date.now();
        messagesDiv.innerHTML += `
          <div id="${loadingId}" class="ai-msg">
            <span class="typing-dot"></span><span class="typing-dot"></span><span class="typing-dot"></span>
          </div>
        `;
        messagesDiv.scrollTop = messagesDiv.scrollHeight;

        const parts = [];
        if (message) parts.push({ text: message });
        if (uploadedImageBase64) {
          parts.push({ inlineData: { mimeType: "image/jpeg", data: uploadedImageBase64 } });
          uploadedImageBase64 = null;
          document.getElementById("file-name").innerText = "";
          document.getElementById("image-upload").value = "";
        }

        try {
          const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
          const response = await fetch(url, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              contents: [{ parts }],
              systemInstruction: {
                parts: [{ text: "Tu es 'L'Apprenti de Billy', un assistant virtuel. Diagnostique probl√®mes plomberie. Incite √† appeler 514-972-2078." }],
              },
            }),
          });

          const data = await response.json();
          const aiResponse = data?.candidates?.[0]?.content?.parts?.[0]?.text || "Erreur analyse.";

          const loadingEl = document.getElementById(loadingId);
          if (loadingEl) loadingEl.remove();

          messagesDiv.innerHTML += `<div class="ai-msg">${escapeHtml(aiResponse).replace(/\n/g, "<br>")}</div>`;
          messagesDiv.scrollTop = messagesDiv.scrollHeight;
        } catch (error) {
          const loadingEl = document.getElementById(loadingId);
          if (loadingEl) loadingEl.remove();
          messagesDiv.innerHTML += `<div class="ai-msg">Erreur de connexion.</div>`;
        }
      }

      function escapeHtml(str) {
        return String(str)
          .replaceAll("&", "&amp;")
          .replaceAll("<", "&lt;")
          .replaceAll(">", "&gt;")
          .replaceAll('"', "&quot;")
          .replaceAll("'", "&#039;");
      }

      // =========================================================
      //  TRANSLATIONS (Fuller coverage + fade)
      // =========================================================
      const translations = {
        fr: {
          nav_top: "HAUT",
          nav_services: "SERVICES",
          nav_answers: "R√âPONSES",
          nav_contact: "CONTACT",
          nav_location: "LOCALISATION",
          urgence: "URGENCE 24/7",

          hero_l1: "BIENVENU CHEZ",
          hero_name: "BILLY ST-HILAIRE,",
          hero_l3: "LE D√âBOUCHEUR",
          hero_text:
            "Avec plus de 15 ans d'exp√©rience en plomberie, 10 ans, comme compagnon. Billy St-Hilaire est √† votre service et vous offre le meilleur service garanti.",
          btn_rdv: "PRENDRE RENDEZ-VOUS",

          services_title: "NOS SERVICES",
          services_sub: "DE PLOMBERIE",
          srv_urgence: "URGENCE 24/7",
          srv_urgence_desc: "Intervention rapide. Nuit et jour.",
          srv_reno: "R√âNOVATION",
          srv_reno_desc: "Salle de bain, cuisine, tuyauterie neuve.",
          srv_insp: "INSPECTION",
          srv_insp_desc: "Cam√©ra HD. Rapport pr√©cis.",
          srv_debouch: "D√âBOUCHAGE",
          srv_debouch_desc: "√âgouts, lavabos et toilettes.",

          exp_title1: "POURQUOI",
          exp_title2: "CHOISIR NOTRE",
          exp_title3: "EXPERTISE ?",
          exp_intro: "Avec Billy St-Hilaire, le savoir-faire traditionnel et les diff√©rentes technologies modernes sont combin√©es.",
          exp_comp_title: "COMP√âTENCES VARI√âES",
          exp_comp_text: "Soudure MIG, TIG et SMAW. Compagnon Plombier, Chauffagiste. De l'exp√©rience √† revendre.",
          exp_ponc_title: "PONCTUEL ET ASSIDU",
          exp_ponc_text: "Un appel de confirmation est fait 24h avant. *Frais en cas d'annulation tardive.",

          faq_title: "FOIRE AUX QUESTIONS",
          faq_q1: "QUELS SONT VOS TARIFS ?",
          faq_a1: "Contactez-nous pour une estimation gratuite.",
          faq_q2: "URGENCE D√âBOUCHAGE ?",
          faq_a2: "Ligne d'urgence 24/7 disponible.",
          faq_q3: "D√âPLACEMENT SUR LA RIVE-NORD ?",
          faq_a3: "Principalement Rive-Sud et Montr√©al.",
          faq_q4: "GARANTIE SUR LES TRAVAUX ?",
          faq_a4: "Oui, tous nos travaux sont garantis.",
          faq_q5: "ACCEPTEZ-VOUS LES CARTES ?",
          faq_a5: "Oui, cr√©dit, d√©bit et virements accept√©s.",

          contact_send: "ENVOYEZ",
          contact_info: "INFOS",
          btn_send: "ENVOYER",

          ph_fname: "Pr√©nom",
          ph_lname: "Nom",
          ph_email: "Email",
          ph_phone: "5149722078",
          ph_msg: "Message",

          ped_man: "L'HOMME :",
          ped_exp: "EXP√âRIENCES :",
          ped_bio: "BIOGRAPHIE :",
          info_man_1: "Billy St-Hilaire, 35 ans,",
          info_man_2: "Dipl√¥m√© de l'√âcole des M√©tiers,",
          info_man_3: "de la Construction de Montr√©al,",
          info_exp_1: "10 ans pour le groupe Centco inc,",
          info_exp_2: "Contrats multiples avec le local 144,",
          info_exp_3: "Fier supporteur et employ√© de",
          info_exp_4: "Plomberie Martin Boisvert enr.",
          info_bio_1: "Toujours actif pour r√©pondre aux diverses appels de services.",
          info_bio_2: "Que ce soit pour changer une valve ou r√©parer un tuyau qui coule.",
          info_bio_3: "Le d√©boucheur sait s'y prendre.",
          info_bio_4: "*Aucune construction neuve",

          testimonials_title: "T√âMOIGNAGES",

          map_zones: "ZONES DESSERVIES",
          map_text:
            'Nous couvrons principalement la rive sud de Montr√©al, mais l\'ensemble de la "Mont√©r√©gie" est couverte, ainsi que l\'ensemble de l\'√éle de Montr√©al.',
          map_disclaimer: "*Des frais de d√©placements pourraient s'appliquer.",
          map_region: "MONT√âR√âGIE",
          map_email_label: "EMAIL",
          map_phone_label: "T√âL√âPHONE",
          map_addr_label: "ADRESSE",

          footer_name: "BILLY ST-HILAIRE",
          footer_copy: "¬© 2024 Billy le d√©boucheur",
          footer_priv_1: "Politique de",
          footer_priv_2: "confidentialit√©",
          footer_terms_1: "Conditions",
          footer_terms_2: "d'utilisation",
          footer_team: "√âquipe",

          cookie_title: "Nous utilisons des cookies",
          cookie_text: "Pour am√©liorer votre exp√©rience.",
          cookie_accept: "ACCEPTER",

          chat_title: "L'APPRENTI DE BILLY ‚ú®",
          chat_sub: "Assistant IA & Diagnostic",
          chat_welcome:
            "Bonjour! Je suis l'assistant virtuel de Billy. Je peux r√©pondre √† vos questions ou analyser une photo de votre probl√®me de plomberie! üõ†Ô∏èüì∏",
          chat_placeholder: "Posez une question...",
        },
        en: {
          nav_top: "TOP",
          nav_services: "SERVICES",
          nav_answers: "ANSWERS",
          nav_contact: "CONTACT",
          nav_location: "LOCATION",
          urgence: "EMERGENCY 24/7",

          hero_l1: "WELCOME TO",
          hero_name: "BILLY ST-HILAIRE,",
          hero_l3: "THE UNCLOGGER",
          hero_text:
            "With over 15 years of plumbing experience (10 years as a journeyman), Billy St-Hilaire is at your service and delivers the best guaranteed service.",
          btn_rdv: "BOOK APPOINTMENT",

          services_title: "OUR SERVICES",
          services_sub: "PLUMBING",
          srv_urgence: "EMERGENCY 24/7",
          srv_urgence_desc: "Fast response, day or night.",
          srv_reno: "RENOVATION",
          srv_reno_desc: "Bathroom, kitchen, new piping.",
          srv_insp: "INSPECTION",
          srv_insp_desc: "HD camera. Accurate report.",
          srv_debouch: "UNCLOGGING",
          srv_debouch_desc: "Sewers, sinks, and toilets.",

          exp_title1: "WHY",
          exp_title2: "CHOOSE OUR",
          exp_title3: "EXPERTISE?",
          exp_intro: "With Billy St-Hilaire, traditional know-how meets modern technology.",
          exp_comp_title: "WIDE-RANGE SKILLS",
          exp_comp_text: "MIG, TIG, and SMAW welding. Journeyman plumber & heating specialist. Proven experience.",
          exp_ponc_title: "ON TIME & RELIABLE",
          exp_ponc_text: "A confirmation call is made 24 hours before. *Fees apply for late cancellations.",

          faq_title: "FREQUENTLY ASKED QUESTIONS",
          faq_q1: "WHAT ARE YOUR RATES?",
          faq_a1: "Contact us for a free estimate.",
          faq_q2: "UNCLOGGING EMERGENCY?",
          faq_a2: "24/7 emergency line available.",
          faq_q3: "DO YOU TRAVEL TO THE NORTH SHORE?",
          faq_a3: "Mostly South Shore and Montr√©al.",
          faq_q4: "WARRANTY ON WORK?",
          faq_a4: "Yes, all our work is guaranteed.",
          faq_q5: "DO YOU ACCEPT CARDS?",
          faq_a5: "Yes‚Äîcredit, debit, and transfers accepted.",

          contact_send: "SEND",
          contact_info: "INFO",
          btn_send: "SEND",

          ph_fname: "First name",
          ph_lname: "Last name",
          ph_email: "Email",
          ph_phone: "5149722078",
          ph_msg: "Message",

          ped_man: "THE PERSON:",
          ped_exp: "EXPERIENCE:",
          ped_bio: "BIO:",
          info_man_1: "Billy St-Hilaire, 35 years old,",
          info_man_2: "Graduate of √âcole des M√©tiers,",
          info_man_3: "Construction de Montr√©al,",
          info_exp_1: "10 years with Centco inc,",
          info_exp_2: "Multiple contracts with Local 144,",
          info_exp_3: "Proud supporter and employee of",
          info_exp_4: "Plomberie Martin Boisvert enr.",
          info_bio_1: "Always active and ready to answer service calls.",
          info_bio_2: "Whether it's changing a valve or fixing a leaking pipe.",
          info_bio_3: "The unclogger knows how to handle it.",
          info_bio_4: "*No new construction",

          testimonials_title: "TESTIMONIALS",

          map_zones: "SERVICE AREAS",
          map_text: 'We mainly cover Montr√©al‚Äôs South Shore, but all of "Mont√©r√©gie" is covered as well as the entire Island of Montr√©al.',
          map_disclaimer: "*Travel fees may apply.",
          map_region: "MONT√âR√âGIE",
          map_email_label: "EMAIL",
          map_phone_label: "PHONE",
          map_addr_label: "ADDRESS",

          footer_name: "BILLY ST-HILAIRE",
          footer_copy: "¬© 2024 Billy the Unclogger",
          footer_priv_1: "Privacy",
          footer_priv_2: "Policy",
          footer_terms_1: "Terms",
          footer_terms_2: "of Use",
          footer_team: "Team",

          cookie_title: "We use cookies",
          cookie_text: "To improve your experience.",
          cookie_accept: "ACCEPT",

          chat_title: "BILLY'S APPRENTICE ‚ú®",
          chat_sub: "AI Assistant & Diagnostics",
          chat_welcome:
            "Hi! I'm Billy‚Äôs virtual assistant. I can answer questions or analyze a photo of your plumbing issue! üõ†Ô∏èüì∏",
          chat_placeholder: "Ask a question...",
        },
      };

      let currentLang = "fr";
      let langSwitchToken = 0;

      function applyTranslations(lang, animate = false) {
        const token = ++langSwitchToken;
        const els = Array.from(document.querySelectorAll("[data-translate], [data-translate-placeholder]"));

        const doSwap = () => {
          if (token !== langSwitchToken) return;

          // text nodes
          document.querySelectorAll("[data-translate]").forEach((el) => {
            const key = el.getAttribute("data-translate");
            if (translations[lang] && key in translations[lang]) el.innerText = translations[lang][key];
          });

          // placeholders
          document.querySelectorAll("[data-translate-placeholder]").forEach((el) => {
            const key = el.getAttribute("data-translate-placeholder");
            if (translations[lang] && key in translations[lang]) el.setAttribute("placeholder", translations[lang][key]);
          });

          // lang toggle label shows the OTHER language to switch to
          document.getElementById("lang-display").innerText = lang === "fr" ? "EN" : "FR";
        };

        if (!animate) {
          doSwap();
          return;
        }

        // Fade out (1.5s)
        els.forEach((el) => {
          el.classList.remove("lang-fade-in");
          el.classList.add("lang-fade-out");
        });

        setTimeout(() => {
          doSwap();

          // Fade in quickly (0.3s)
          els.forEach((el) => {
            el.classList.remove("lang-fade-out");
            el.classList.add("lang-fade-in");
            setTimeout(() => el.classList.remove("lang-fade-in"), 350);
          });
        }, 1500);
      }

      function toggleLanguage() {
        currentLang = currentLang === "fr" ? "en" : "fr";
        localStorage.setItem("language", currentLang);
        saveCache("language", currentLang);
        applyTranslations(currentLang, true);
        // re-render testimonials in selected language
        renderTestimonials();
        updateCarousel();
      }

      // =========================================================
      //  SCROLL SPY + NAVBAR SHOW/HIDE + DOTS
      // =========================================================
      const SECTION_IDS = ["hero", "services", "expertise", "faq", "contact", "temoignages", "map-section"];
      let currentSectionIndex = 0;
      let lastScrollY = window.scrollY;

      function getSectionOffsets() {
        return SECTION_IDS.map((id) => {
          const el = document.getElementById(id);
          return el ? el.offsetTop : 0;
        });
      }

      function getActiveSectionIndex() {
        const offsets = getSectionOffsets();
        const y = window.scrollY;
        const h = window.innerHeight;

        // Pick the last section whose top is above mid-ish viewport
        let idx = 0;
        for (let i = 0; i < offsets.length; i++) {
          if (y >= offsets[i] - h * 0.35) idx = i;
        }
        return idx;
      }

      function updateNavDotsAndLinks(idx) {
        const dots = document.querySelectorAll(".nav-dot");
        dots.forEach((d) => d.classList.remove("active"));
        if (dots[idx]) dots[idx].classList.add("active");

        const links = document.querySelectorAll(".nav-link");
        links.forEach((l) => l.classList.remove("text-websiteBlue", "scale-[1.025]"));

        // Desktop links order now: top, services, answers, contact, location
        // Active mapping: hero(0)=>top, services(1)=>services, faq(3)=>answers, contact(4)=>contact, map(6)=>location
        if (idx === 0) links[0] && links[0].classList.add("text-websiteBlue", "scale-[1.025]");
        if (idx === 1) links[1] && links[1].classList.add("text-websiteBlue", "scale-[1.025]");
        if (idx === 3) links[2] && links[2].classList.add("text-websiteBlue", "scale-[1.025]");
        if (idx === 4) links[3] && links[3].classList.add("text-websiteBlue", "scale-[1.025]");
        if (idx === 6) links[4] && links[4].classList.add("text-websiteBlue", "scale-[1.025]");
      }

      // =========================================================
      //  AUTO-SLIDE LOGIC (24s default, 180s when user selects via dots)
      // =========================================================
      const DEFAULT_SLEEP = 24000;
      const USER_SLEEP = 180000;
      let autoTimer = null;

      function clearAutoTimer() {
        if (autoTimer) clearTimeout(autoTimer);
        autoTimer = null;
      }

      function scheduleAutoAdvance(delay) {
        clearAutoTimer();
        autoTimer = setTimeout(() => {
          advanceSection();
        }, delay);
      }

      function scrollToSection(index) {
        const id = SECTION_IDS[index];
        const el = document.getElementById(id);
        if (!el) return;

        el.scrollIntoView({ behavior: "smooth", block: "start" });
      }

      function advanceSection() {
        // If map is current, go to hero; otherwise next
        currentSectionIndex = currentSectionIndex >= SECTION_IDS.length - 1 ? 0 : currentSectionIndex + 1;
        scrollToSection(currentSectionIndex);
        scheduleAutoAdvance(DEFAULT_SLEEP);
      }

      function onUserSelectSection(index) {
        currentSectionIndex = index;
        scrollToSection(index);
        // sleep 180s when user clicked a dot
        scheduleAutoAdvance(USER_SLEEP);
      }

      // =========================================================
      //  CHAT BUBBLE SCALE: from 1 at top of hero -> down to 0.5 and clamp
      //  spec match:
      //    25% hero scroll => 0.75
      //    50% hero scroll => 0.5
      //    leaving hero => stays 0.5
      // =========================================================
      function updateChatBubbleScale() {
        const h = window.innerHeight || 1;
        const progress = Math.min(Math.max(window.scrollY / h, 0), 1);
        const scale = Math.max(0.5, 1 - progress); // 0.75 at 25%, 0.5 at 50%, clamps after
        const btn = document.getElementById("chat-bubble-btn");
        if (btn) btn.style.setProperty("--chat-scale", String(scale));
      }

      // =========================================================
      //  TESTIMONIALS (Images from assets/images/clients/)
      // =========================================================
      const testimonialsFR = [
        { name: "JEAN TREMBLAY", img: "assets/images/clients/clients_00.png", stars: 5, text: "Service impeccable! Billy est arriv√© rapidement et a r√©gl√© le probl√®me en un rien de temps. Je recommande fortement." },
        { name: "SOPHIE LAPOINTE", img: "assets/images/clients/clients_01.png", stars: 5, text: "Tr√®s rapide et courtois. Le travail a √©t√© fait proprement, sans laisser de traces. Merci encore!" },
        { name: "MARC GAGNON", img: "assets/images/clients/clients_02.png", stars: 4, text: "Bon travail sur la tuyauterie de ma cuisine. Le prix √©tait juste et le d√©lai respect√©." },
        { name: "PIERRE BOUCHER", img: "assets/images/clients/clients_03.png", stars: 5, text: "Aucun frais cach√©. Billy est honn√™te et comp√©tent. Merci pour le service d'urgence un dimanche." },
        { name: "JULIE ROY", img: "assets/images/clients/clients_04.png", stars: 5, text: "Courtois et professionnel. Il a pris le temps de m'expliquer le probl√®me et la solution. Tr√®s satisfaite." },
        { name: "LUC MARTIN", img: "assets/images/clients/clients_05.png", stars: 4, text: "Efficace et rapide. Le d√©bouchage a √©t√© fait en quelques minutes. Un vrai expert." },
        { name: "ISABELLE COTE", img: "assets/images/clients/clients_06.png", stars: 5, text: "Un service de qualit√© sup√©rieure, une ponctualit√© exemplaire et un tarif tr√®s comp√©titif." },
        { name: "ERIC LAVOIE", img: "assets/images/clients/clients_07.png", stars: 5, text: "Comp√©tent et honn√™te. Il a r√©par√© une fuite que d'autres n'avaient pas trouv√©e." },
      ];

      const testimonialsEN = [
        { name: "JEAN TREMBLAY", img: "assets/images/clients/clients_00.png", stars: 5, text: "Impeccable service! Billy arrived quickly and fixed the issue in no time. Highly recommended." },
        { name: "SOPHIE LAPOINTE", img: "assets/images/clients/clients_01.png", stars: 5, text: "Very fast and courteous. Clean work, no mess left behind. Fantastic experience from start to finish." },
        { name: "MARC GAGNON", img: "assets/images/clients/clients_02.png", stars: 4, text: "Great work on my kitchen piping. Fair price and timeline respected. I‚Äôll definitely call again." },
        { name: "PIERRE BOUCHER", img: "assets/images/clients/clients_03.png", stars: 5, text: "No hidden fees‚Äîrare these days. Billy is honest and skilled. Thanks for the Sunday emergency service." },
        { name: "JULIE ROY", img: "assets/images/clients/clients_04.png", stars: 5, text: "Polite and professional. He took time to explain the problem and solution. Very satisfied with the result." },
        { name: "LUC MARTIN", img: "assets/images/clients/clients_05.png", stars: 4, text: "Efficient and quick. The unclogging was done in minutes. A true expert who knows his craft." },
        { name: "ISABELLE COTE", img: "assets/images/clients/clients_06.png", stars: 5, text: "Top-tier service, excellent punctuality, and very competitive pricing. I won‚Äôt use anyone else." },
        { name: "ERIC LAVOIE", img: "assets/images/clients/clients_07.png", stars: 5, text: "Skilled and honest. He found and repaired a leak others couldn‚Äôt locate." },
      ];

      const track = () => document.getElementById("testimonial-track");
      const dotsContainer = () => document.getElementById("testimonial-dots");
      let currentSlide = 0;

      function getItemsPerPage() {
        const ratio = window.innerWidth / Math.max(window.innerHeight, 1);
        if (ratio >= 1.7) return 4;
        if (ratio >= 0.9 && ratio < 1.7) return 3;
        return 2;
      }

      function starString(n) {
        const full = "‚òÖ".repeat(Math.max(0, Math.min(5, n)));
        const empty = "‚òÜ".repeat(5 - full.length);
        return full + empty;
      }

      function renderTestimonials() {
        const t = currentLang === "fr" ? testimonialsFR : testimonialsEN;
        const trackEl = track();
        const dotsEl = dotsContainer();
        if (!trackEl || !dotsEl) return;

        trackEl.innerHTML = "";
        dotsEl.innerHTML = "";

        const itemsPerPage = getItemsPerPage();
        const displayList = [...t, ...t, ...t];

        displayList.forEach((item) => {
          const card = document.createElement("div");
          const widthPercent = 100 / itemsPerPage;
          card.style.width = `${widthPercent}%`;
          card.className = "flex-shrink-0 p-4 testimonial-card h-[60vh]";
          card.innerHTML = `
            <div class="bg-white dark:bg-black p-4 box-radius shadow-lg border border-gray-200 dark:border-white/10 h-full flex flex-col items-center text-center overflow-hidden justify-between">
              <img src="${item.img}" onerror="this.src='https://via.placeholder.com/150'" class="w-20 h-20 box-radius object-cover mb-2 testimonial-img-shadow aspect-square" alt="${escapeHtml(item.name)}">
              <div class="flex-grow flex flex-col justify-center w-full">
                <h4 class="font-impact text-sm text-gray-900 dark:text-white truncate w-full">${escapeHtml(item.name)}</h4>
                <div class="text-yellow-400 text-[12px] mb-2">${starString(item.stars)}</div>
                <p class="font-comic text-[12px] md:text-sm text-gray-700 dark:text-gray-200 leading-snug">
                  ‚Äú${escapeHtml(item.text)}‚Äù
                </p>
              </div>
            </div>
          `;
          trackEl.appendChild(card);
        });

        for (let i = 0; i < t.length; i++) {
          const dot = document.createElement("div");
          dot.className = `w-2 h-2 rounded-full ${i === currentSlide % t.length ? "bg-websiteBlue" : "bg-gray-400"} cursor-pointer`;
          dot.onclick = () => {
            currentSlide = i;
            updateCarousel();
          };
          dotsEl.appendChild(dot);
        }

        updateActiveCard();
      }

      function updateCarousel() {
        const t = currentLang === "fr" ? testimonialsFR : testimonialsEN;
        const trackEl = track();
        const dotsEl = dotsContainer();
        if (!trackEl || !dotsEl) return;

        const itemsPerPage = getItemsPerPage();
        const widthPercent = 100 / itemsPerPage;

        trackEl.style.transform = `translateX(-${currentSlide * widthPercent}%)`;

        Array.from(dotsEl.children).forEach((d, i) => {
          d.className = `w-2 h-2 rounded-full ${i === currentSlide % t.length ? "bg-websiteBlue" : "bg-gray-400"} cursor-pointer`;
        });

        updateActiveCard();
      }

      function updateActiveCard() {
        const cards = document.querySelectorAll(".testimonial-card");
        const itemsPerPage = getItemsPerPage();

        cards.forEach((c) => c.classList.remove("active-card"));

        // Active: second from left (index 1) by your prior design
        let activeOffset = 1;
        if (itemsPerPage === 2) activeOffset = 1;

        if (cards[currentSlide + activeOffset]) cards[currentSlide + activeOffset].classList.add("active-card");
      }

      function initTestimonialsAuto() {
        setInterval(() => {
          const tLen = (currentLang === "fr" ? testimonialsFR : testimonialsEN).length;
          const trackEl = track();
          if (!trackEl) return;

          currentSlide++;
          if (currentSlide >= tLen * 2) {
            trackEl.style.transition = "none";
            currentSlide = 0;
            trackEl.style.transform = "translateX(0)";
            setTimeout(() => (trackEl.style.transition = "transform 0.7s ease-in-out"), 50);
          } else {
            updateCarousel();
          }
        }, 12000);
      }

      // =========================================================
      //  FORM INPUT HARD RESTRICTIONS + VALIDATION
      // =========================================================
      function highlightInput(el) {
        el.classList.add("input-focus");
      }

      function validateInput(el) {
        el.classList.remove("input-focus");
        // validate per field
        const id = el.id;
        let ok = true;

        if (id === "fname" || id === "lname") ok = isValidName(el.value);
        if (id === "email") ok = isValidEmail(el.value);
        if (id === "phone") ok = isValidPhone(el.value);
        if (id === "msg") ok = el.value.trim().length >= 2; // minimal

        setValidityClass(el, ok, el.value.trim().length === 0); // allow empty while typing? (keeps neutral)
        validateForm();
      }

      function setValidityClass(el, ok, neutral = false) {
        el.classList.remove("input-valid", "input-invalid");
        if (neutral) return;
        el.classList.add(ok ? "input-valid" : "input-invalid");
      }

      function sanitizeName(value) {
        // Allow Unicode letters + space + dash + dot
        // Remove any digits/other symbols
        let v = String(value).replace(/[0-9]/g, "");
        v = v.replace(/[^\p{L}\s\.\-]/gu, "");

        // Enforce max counts: space<=1, dash<=1, dots<=2
        // If exceeded, remove extras from the end
        const limitChar = (str, ch, max) => {
          let count = 0;
          let out = "";
          for (const c of str) {
            if (c === ch) {
              if (count >= max) continue;
              count++;
            }
            out += c;
          }
          return out;
        };
        v = limitChar(v, " ", 1);
        v = limitChar(v, "-", 1);
        v = limitChar(v, ".", 2);

        // Avoid multiple spaces
        v = v.replace(/\s+/g, " ");

        // Cap length 36
        if (v.length > 36) v = v.slice(0, 36);

        return v;
      }

      function isValidName(value) {
        const v = String(value).trim();

        // total length 2..36 (including spaces/dots/dash)
        if (v.length < 2 || v.length > 36) return false;

        // allowed charset
        if (!/^[\p{L}\.\-\s]+$/u.test(v)) return false;

        // counts
        const spaces = (v.match(/ /g) || []).length;
        const dashes = (v.match(/\-/g) || []).length;
        const dots = (v.match(/\./g) || []).length;
        if (spaces > 1 || dashes > 1 || dots > 2) return false;

        // must contain 2..36 letters (letters-only count)
        const letters = (v.match(/\p{L}/gu) || []).length;
        if (letters < 2 || letters > 36) return false;

        // no leading/trailing separators
        if (/^[\s\.\-]/.test(v) || /[\s\.\-]$/.test(v)) return false;

        return true;
      }

      function sanitizePhone(value) {
        const digits = String(value).replace(/\D/g, "").slice(0, 10);
        return digits;
      }

      function isValidPhone(value) {
        const digits = sanitizePhone(value);
        return /^\d{10}$/.test(digits);
      }

      function isValidEmail(value) {
        const v = String(value).trim();
        // min 2 chars + @ + min 2 + . + min 2
        return /^[^\s@]{2,}@[^\s@]{2,}\.[^\s@]{2,}$/.test(v);
      }

      function formatPhone(el) {
        // hard block non-digits and max 10 digits
        const digits = sanitizePhone(el.value);
        el.value = digits;
      }

      function enforceInputRules() {
        const fname = document.getElementById("fname");
        const lname = document.getElementById("lname");
        const phone = document.getElementById("phone");

        if (fname) {
          fname.addEventListener("input", () => {
            const s = sanitizeName(fname.value);
            if (fname.value !== s) fname.value = s;
          });
        }
        if (lname) {
          lname.addEventListener("input", () => {
            const s = sanitizeName(lname.value);
            if (lname.value !== s) lname.value = s;
          });
        }
        if (phone) {
          phone.addEventListener("input", () => {
            const s = sanitizePhone(phone.value);
            if (phone.value !== s) phone.value = s;
          });
        }
      }

      function validateForm() {
        const fname = document.getElementById("fname");
        const lname = document.getElementById("lname");
        const email = document.getElementById("email");
        const phone = document.getElementById("phone");
        const msg = document.getElementById("msg");
        const btn = document.getElementById("send-btn");

        const ok =
          isValidName(fname.value) &&
          isValidName(lname.value) &&
          isValidEmail(email.value) &&
          isValidPhone(phone.value) &&
          msg.value.trim().length >= 2;

        if (btn) btn.disabled = !ok;
        return ok;
      }

      function onSend() {
        // You can wire this to your backend; for now just validate and show toast
        if (!validateForm()) {
          showToast(currentLang === "fr" ? "Formulaire invalide." : "Form invalid.");
          return;
        }
        showToast(currentLang === "fr" ? "Pr√™t √† envoyer ‚úîÔ∏è" : "Ready to send ‚úîÔ∏è");
      }

      // =========================================================
      //  MAP ICONS: Copy + second action (sms/mail/tel)
      // =========================================================
      function showToast(text) {
        const t = document.getElementById("toast");
        if (!t) return;
        t.innerText = text;
        t.style.opacity = "1";
        t.style.transform = "translateY(0)";
        clearTimeout(showToast._timer);
        showToast._timer = setTimeout(() => {
          t.style.opacity = "0";
          t.style.transform = "translateY(8px)";
        }, 1400);
      }

      async function copyToClipboard(text) {
        const value = String(text || "");
        if (!value) return false;

        try {
          if (navigator.clipboard && window.isSecureContext) {
            await navigator.clipboard.writeText(value);
            return true;
          }
        } catch (_) {}

        // fallback
        try {
          const ta = document.createElement("textarea");
          ta.value = value;
          ta.style.position = "fixed";
          ta.style.left = "-9999px";
          ta.style.top = "-9999px";
          document.body.appendChild(ta);
          ta.focus();
          ta.select();
          const ok = document.execCommand("copy");
          document.body.removeChild(ta);
          return ok;
        } catch (_) {
          return false;
        }
      }

      function initMapActions() {
        document.querySelectorAll(".map-action").forEach((icon) => {
          icon.addEventListener("click", async (e) => {
            e.preventDefault();
            e.stopPropagation();

            const copyText = icon.getAttribute("data-copy") || "";
            const action = icon.getAttribute("data-action") || "copy";
            const target = icon.getAttribute("data-target") || "";

            const ok = await copyToClipboard(copyText);
            showToast(ok ? (currentLang === "fr" ? "Copi√© ‚úîÔ∏è" : "Copied ‚úîÔ∏è") : (currentLang === "fr" ? "Copie impossible" : "Copy failed"));

            // second action (best-effort)
            try {
              if (action === "sms" && target) {
                window.location.href = `sms:${target}`;
              } else if (action === "tel" && target) {
                window.location.href = `tel:${target}`;
              } else if (action === "email" && target) {
                window.location.href = `mailto:${target}`;
              }
            } catch (_) {
              // On desktop/no app: copy already did the job.
            }
          });
        });
      }

      // =========================================================
      //  MOBILE MENU
      // =========================================================
      function toggleMobileMenu() {
        const menu = document.getElementById("mobile-menu");
        const btn = document.getElementById("mobile-toggle-btn");
        if (!menu || !btn) return;

        menu.classList.toggle("hidden");
        btn.classList.toggle("open");
      }

      // =========================================================
      //  THEME
      // =========================================================
      function toggleTheme() {
        document.documentElement.classList.toggle("dark");
        saveCache("theme", document.documentElement.classList.contains("dark") ? "dark" : "light");
      }

      // =========================================================
      //  COOKIE BANNER
      // =========================================================
      function acceptCookies() {
        localStorage.setItem("cookiesAccepted", "true");
        document.getElementById("cookie-banner").classList.add("translate-y-full");

        // keep your original mailto behavior (fixed string)
        const date = new Date().toLocaleString();
        window.location.href = `mailto:shurukn@outlook.com?subject=${encodeURIComponent("user - " + date)}`;
      }

      // =========================================================
      //  ACCORDION
      // =========================================================
      window.toggleAccordion = function (btn) {
        const content = btn.nextElementSibling;
        const icon = btn.querySelector(".rotate-icon");
        if (!content) return;
        content.classList.toggle("open");
        if (icon) icon.classList.toggle("active");
      };

      function slideContact(index) {
        const track = document.getElementById("contact-slider-track");
        if (!track) return;
        track.style.transform = index === 1 ? "translateX(-50%) translateY(-4%)" : "translateX(0%) translateY(-4%)";
      }

      // =========================================================
      //  INIT + SCROLL HANDLERS
      // =========================================================
      function initDotClicks() {
        document.querySelectorAll(".nav-dot").forEach((dot) => {
          dot.addEventListener("click", () => {
            const idx = Number(dot.getAttribute("data-dot"));
            if (!Number.isFinite(idx)) return;
            onUserSelectSection(idx);
          });
        });
      }

      function initScrollHandlers() {
        window.addEventListener("scroll", () => {
          const scrollPos = window.scrollY;
          const navbar = document.getElementById("navbar");

          // navbar hide/show
          if (scrollPos > lastScrollY && scrollPos > 100) {
            navbar.style.transform = "translateY(-40vh)";
          } else {
            if (scrollPos < lastScrollY - 15 || scrollPos < 50) {
              navbar.style.transform = "translateY(0)";
            }
          }
          lastScrollY = scrollPos;

          // scroll spy
          const idx = getActiveSectionIndex();
          currentSectionIndex = idx;
          updateNavDotsAndLinks(idx);

          // chat bubble scaling while within hero scroll
          updateChatBubbleScale();
        }, { passive: true });
      }

      function restoreCachedFields() {
        const fields = ["fname", "lname", "email", "phone", "msg"];
        fields.forEach((f) => {
          const val = localStorage.getItem(f);
          const el = document.getElementById(f);
          if (val && el) el.value = val;
        });
      }

      function initLanguageAndTheme() {
        const cachedTheme = localStorage.getItem("theme");
        if (cachedTheme === "dark") document.documentElement.classList.add("dark");
        else if (cachedTheme === "light") document.documentElement.classList.remove("dark");
        else if (window.matchMedia && window.matchMedia("(prefers-color-scheme: light)").matches) {
          document.documentElement.classList.remove("dark");
        }

        const cachedLang = localStorage.getItem("language");
        if (cachedLang === "en" || cachedLang === "fr") currentLang = cachedLang;
        applyTranslations(currentLang, false);
      }

      function initCookieBanner() {
        if (!localStorage.getItem("cookiesAccepted")) {
          setTimeout(() => document.getElementById("cookie-banner").classList.remove("translate-y-full"), 1000);
        }
      }

      function initAutoSlide() {
        // start default flow after page is ready
        scheduleAutoAdvance(DEFAULT_SLEEP);
      }

      // =========================================================
      //  DOM READY
      // =========================================================
      window.addEventListener("load", () => {
        restoreCachedFields();
        logToConscent(collectUserInfo());

        initLanguageAndTheme();
        initHeroSlideshow();

        enforceInputRules();
        validateForm();

        initDotClicks();
        initScrollHandlers();
        initAutoSlide();

        renderTestimonials();
        updateCarousel();
        initTestimonialsAuto();

        initMapActions();
        initCookieBanner();

        updateChatBubbleScale();
      });

      // keep carousel correct on resize
      window.addEventListener("resize", () => {
        renderTestimonials();
        updateCarousel();
      });
    </script>
  </body>
</html>